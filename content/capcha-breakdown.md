---
title: "Як учасник ІТ КПІ капчу ламав."
date: 2016-01-18T04:54:40.519997-05:00
draft: false
author: itkpi
email: it@kpi.pp.ua
---

<div class="image-wrapper">
    <img src="/images/2016/01/1453110863_3579455f6928454ab6208d69309e7b9d.jpg" class="post-image full-img">
</div>

## Маємо не зовсім законну, але круту історію про злам капчі. Не повторюйте цього вдома! (А якщо таки захочете - код в кінці посту)
____________________

Якось лазячи в інтернеті я натрапив на сайт, який дозволяв відсилати смс-повідомлення for free. Єдине що засмучувало - там була капча і пару pop-up вікон. Оскільки я мав досвід в керуванні браузером через <a href="http://www.seleniumhq.org/">Selenium</a> і мав певні уявлення про Python, то я вирішив трохи ‘Break Stuff’. 

![](/images/2016/01/1453112265_02ab2de63d054bd8a1ba46eab6b7f6af.jpg)
<br><br>
На щастя капча була доволі проста. Озброївшись терпінням і переліком opensource утиліт OCR для Linux я пішов тестувати яка з них найкраще розпізнає цю капчу. Серед двох найкращих (для Linux) <a href="https://github.com/tesseract-ocr">Tesseract</a> і <a href="https://en.wikipedia.org/wiki/CuneiForm_(software)">Cuneiform </a>я обрав останню, так як вона давала показники 51% вірних розпізнавань на вибірці у 92 капчі, в порівнянні з tesseract 10%. 
<br><br>
Що ще цікаво, то для того щоб розпізнати капчу мені довелося скрінити екран (selenium), обрізати область з капчею і лише тоді передавати на паралельний процес для розпізнавання.
Проблема з капчею була вирішена.

![](/images/2016/01/1453112265_5daf8459a13d49e5b11107775f72380d.jpg) 
<br><br>
Залишалось автоматизувати браузер через selenium. Проте проблема полягала в тому, що в браузері нам потрібно було ввести текст в поле яке мало динамічний id і name, тобто при оновленні сторінки воно мало іншу назву і я не міг напряму заповнити поле по його id в selenium. 
<br><br>
Проте це легко обходилося, завдяки <a href="https://uk.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D1%83%D0%BB%D1%8F%D1%80%D0%BD%D0%B8%D0%B9_%D0%B2%D0%B8%D1%80%D0%B0%D0%B7">Regular Expressions</a>, я взнавав id і name поля вводу пошуком по source коду сторінки і тоді передавав параметри в selenium який заповнював поля для тексту, номеру телефону і для капчі. 
<br><br>
Таким чином в мене вийшло автоматизувати скрипт який заходить на сторінку, закриває всю "вспливаючу" рекламу, розпізнає капчу (51%), заповнює поля і натискає відіслати. Тепер маю спам смс сервіс :)

![](/images/2016/01/1453112265_b1a5db81771c4d97a3184a8abf4c311a.jpg)
<br><br>
P.S: код в <a href ="https://github.com/artemwozniak/OCR_sms_test">моєму Гітхаб-акаунті</a>, і схоже що вони викликали адміна і він забанив мене по IP, проте ну що ж, ввімкну тунелізацію через Tor і продовжу.

Tags: fun

